var margin,width,height,i,duration,root,tree,diagonal,svg,zoom,direction;var nodeindex=0;var i_count_total=0;var i_iteration=0;var i_width_sankey=0;var x_raf;var o_scores=null;var o_labels=[];var s_tstampcode=null;var s_result_set_ref="";var s_scoring_options_ref="";var s_json_tree_original="";var i_max_path_length=0;readyAimFire=function(d,k){o_scores=null;var g=getData();if(g==null){blockQueryError("");b_idle=1}else{if(g.session&&g.session=="false"){window.location="/tcj?e=2";return}else{var m=JSON.stringify(g);i_max_path_length=g.maxpathlength;k=g.direction;s_direction_set=k;if(g.scores!=null){o_scores=g.scores}var b=[];$("#cb_drops").prop("checked",false);$("#cb_eoi_dedupe").prop("checked",false);$("#cb_filter").prop("checked",false);var e="";var j="";var n="";for(var a in g.controls){if(g.controls.hasOwnProperty(a)){if(g.controls[a].name=="s_direction"){k=g.controls[a].value;$("#s_direction").val(k).trigger("change");s_direction_set=k}if(g.controls[a].name=="s_eoi_setting"){$("#s_eoi_setting").val(g.controls[a].value).trigger("change")}if(g.controls[a].name=="t_event"){$("#t_event").val(g.controls[a].value)}if(g.controls[a].name=="s_event"){$("#s_event").val(g.controls[a].value).trigger("change")}if(g.controls[a].name=="cb_first_match"){$("#cb_first_match").val(g.controls[a].value).trigger("change")}if(g.controls[a].name=="cb_drops"){if(g.controls[a].value=="1"){$("#cb_drops").prop("checked",true)}}if(g.controls[a].name=="s_max_events"){$("#s_max_events").val(g.controls[a].value).trigger("change")}if(g.controls[a].name=="s_result_set"){$("#s_result_set").val(g.controls[a].value).trigger("change");s_result_set_ref=g.controls[a].value}if(g.controls[a].name=="s_scoring_options"){s_scoring_options_ref=g.controls[a].value;$("#s_scoring_options").val(s_scoring_options_ref).trigger("change")}if(g.controls[a].name=="s_time_window"){n=g.controls[a].value;recreateTimeWindowSelect(n,"QUERY")}if(n=="CUSTOM"){if(g.controls[a].name=="dp_start"){e=g.controls[a].value}if(g.controls[a].name=="dp_end"){j=g.controls[a].value}}if(g.controls[a].name=="s_dedupe"){$("#s_dedupe").val(g.controls[a].value).trigger("change")}if(g.controls[a].name=="cb_eoi_dedupe"){if(g.controls[a].value=="1"){$("#cb_eoi_dedupe").prop("checked",true)}}if(g.controls[a].name=="cb_filter"){if(g.controls[a].value=="on"){$("#cb_filter").prop("checked",true);toggleFilter();var h=0;for(var l in g.controls){if(g.controls.hasOwnProperty(l)){if(g.controls[l].name.indexOf("and_or_0_")!=-1||g.controls[l].name.indexOf("open_parens_0_")!=-1||g.controls[l].name.indexOf("scope_0_")!=-1||g.controls[l].name.indexOf("field_0_")!=-1||g.controls[l].name.indexOf("condition_0_")!=-1||g.controls[l].name.indexOf("value_0_")!=-1||g.controls[l].name.indexOf("close_parens_0_")!=-1){b[g.controls[l].name]=g.controls[l].value}if(g.controls[l].name.indexOf("open_parens_0_")!=-1){var c=parseInt(g.controls[l].name.substring(14));if(c>0&&$("#open_parens_0_"+c).length==0){addFilter("AND",0)}}}}for(var l in b){if(l.indexOf("and_or_0_")!=-1||l.indexOf("scope_0_")!=-1||l.indexOf("field_0_")!=-1||l.indexOf("condition_0_")!=-1){$("#"+l).val(b[l]).trigger("change")}else{$("#"+l).val(b[l])}}}}}}s_tstampcode=g.tstampcode;if(n=="CUSTOM"&&e!=""&&j!=""){$("#div_custom_dates").css("display","");getMinMaxDate(0,e,j,"QUERY")}if(m.indexOf('{"syntax')==0){var f=JSON.stringify(g.syntax);f=f.substring(1,f.length-1).trim().replace(/\^\|\^/gi,"<br>").trim();if(f.indexOf("SELECT n.path")==0){f=f.replace(/<br>\s{6}/gi,"<br>")}if(g.error!=null){blockQueryError(g.error.trim().replace(/\^\|\^/gi,"<br>&nbsp;&nbsp;").trim())}else{blockQueryError("")}$("#div_syntax_code").html(f);$("#div_sidebar_visualizations").css("display","none");$("#div_sidebar_visualizations_syntax").css("display","");showSyntaxSidebar("syntax");b_idle=1}else{runTree(g,k)}}}};readyAimFireCompare=function(b,c,a){o_scores=null;x_raf=$.get(b,{},function(d){if(d==null||d.totalcounta==null){blockQueryError("");b_idle=1}else{if(d.session&&d.session=="false"){window.location="/tcj?e=2";return}else{var e=JSON.stringify(d);loadHistoryQueryCompare(e,1)}}},"json")};loadHistoryQuery=function(a){var b=$("#s_event").html();if(b.trim()!=""){var c="/tcj/aa?a=LOADHISTORYQUERY&tsc="+encodeURIComponent(a);readyAimFire(c,"")}else{setTimeout(function(){loadHistoryQuery(a)},1000)}};loadHistoryTargetList=function(a){var k=$("#s_event").html();var g=JSON.parse(a);var c=[];$("#cb_drops").prop("checked",false);$("#cb_eoi_dedupe").prop("checked",false);$("#cb_filter").prop("checked",false);var f="";var j="";var m="";for(var b in g.controls){if(g.controls.hasOwnProperty(b)){if(g.controls[b].name=="s_direction"){s_direction=g.controls[b].value;$("#s_direction").val(s_direction).trigger("change");s_direction_set=$("#s_direction").val()}if(g.controls[b].name=="s_eoi_setting"){$("#s_eoi_setting").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="t_event"){$("#t_event").val(g.controls[b].value)}if(g.controls[b].name=="s_event"){$("#s_event").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="cb_first_match"){$("#cb_first_match").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="cb_drops"){if(g.controls[b].value=="1"){$("#cb_drops").prop("checked",true)}}if(g.controls[b].name=="s_max_events"){$("#s_max_events").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="s_result_set"){$("#s_result_set").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="s_time_window"){m=g.controls[b].value;recreateTimeWindowSelect(m,"QUERY")}if(m=="CUSTOM"){if(g.controls[b].name=="dp_start"){f=g.controls[b].value}if(g.controls[b].name=="dp_end"){j=g.controls[b].value}}if(g.controls[b].name=="s_dedupe"){$("#s_dedupe").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="cb_eoi_dedupe"){if(g.controls[b].value=="1"){$("#cb_eoi_dedupe").prop("checked",true)}}if(g.controls[b].name=="cb_filter"){if(g.controls[b].value=="on"){$("#cb_filter").prop("checked",true);toggleFilter();var h=0;for(var l in g.controls){if(g.controls.hasOwnProperty(l)){if(g.controls[l].name.indexOf("and_or_0_")!=-1||g.controls[l].name.indexOf("open_parens_0_")!=-1||g.controls[l].name.indexOf("scope_0_")!=-1||g.controls[l].name.indexOf("field_0_")!=-1||g.controls[l].name.indexOf("condition_0_")!=-1||g.controls[l].name.indexOf("value_0_")!=-1||g.controls[l].name.indexOf("close_parens_0_")!=-1){c[g.controls[l].name]=g.controls[l].value}if(g.controls[l].name.indexOf("open_parens_0_")!=-1){var d=parseInt(g.controls[l].name.substring(14));if(d>0){addFilter("AND",0)}}}}for(var l in c){if(l.indexOf("and_or_0_")!=-1||l.indexOf("scope_0_")!=-1||l.indexOf("field_0_")!=-1||l.indexOf("condition_0_")!=-1){$("#"+l).val(c[l]).trigger("change")}else{$("#"+l).val(c[l])}}}}}}if(m=="CUSTOM"&&f!=""&&j!=""){$("#div_custom_dates").css("display","");getMinMaxDate(0,f,j,"QUERY")}if(k.trim()!=""){var e=$.get("/tcj/aa",{a:"getHistoryTargetList",h:a},function(n){$("#div_target_content").html(n);$("#div_target").css("display","");$("#div_target").css("width",i_workspace_width+"px");$("#div_sidebar_visualizations").css("display","none");$("#div_sidebar_visualizations_target").css("display","");showTargetSidebar("target");refreshTableSorter();$("#t_target_list").trigger("update");$.unblockUI()},"html")}else{setTimeout(function(){loadHistoryTargetList(a)},1000)}};var x_history_report="";loadHistoryReport=function(o){x_history_report=o;var n=$("#s_event").html();var g=JSON.parse(o);var c=[];$("#cb_drops").prop("checked",false);$("#cb_eoi_dedupe").prop("checked",false);$("#cb_filter").prop("checked",false);var e="";var l="";var r="";for(var b in g.controls){if(g.controls.hasOwnProperty(b)){if(g.controls[b].name=="s_direction"){s_direction=g.controls[b].value;$("#s_direction").val(s_direction).trigger("change");s_direction_set=$("#s_direction").val()}if(g.controls[b].name=="s_eoi_setting"){$("#s_eoi_setting").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="t_event"){$("#t_event").val(g.controls[b].value)}if(g.controls[b].name=="s_event"){$("#s_event").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="cb_first_match"){$("#cb_first_match").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="cb_drops"){if(g.controls[b].value=="1"){$("#cb_drops").prop("checked",true)}}if(g.controls[b].name=="s_max_events"){$("#s_max_events").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="s_result_set"){$("#s_result_set").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="s_time_window"){r=g.controls[b].value;recreateTimeWindowSelect(r,"QUERY")}if(r=="CUSTOM"){if(g.controls[b].name=="dp_start"){e=g.controls[b].value}if(g.controls[b].name=="dp_end"){l=g.controls[b].value}}if(g.controls[b].name=="s_dedupe"){$("#s_dedupe").val(g.controls[b].value).trigger("change")}if(g.controls[b].name=="cb_eoi_dedupe"){if(g.controls[b].value=="1"){$("#cb_eoi_dedupe").prop("checked",true)}}if(g.controls[b].name=="cb_filter"){if(g.controls[b].value=="on"){$("#cb_filter").prop("checked",true);toggleFilter();var k=0;for(var p in g.controls){if(g.controls.hasOwnProperty(p)){if(g.controls[p].name.indexOf("and_or_0_")!=-1||g.controls[p].name.indexOf("open_parens_0_")!=-1||g.controls[p].name.indexOf("scope_0_")!=-1||g.controls[p].name.indexOf("field_0_")!=-1||g.controls[p].name.indexOf("condition_0_")!=-1||g.controls[p].name.indexOf("value_0_")!=-1||g.controls[p].name.indexOf("close_parens_0_")!=-1){c[g.controls[p].name]=g.controls[p].value}if(g.controls[p].name.indexOf("open_parens_0_")!=-1){var d=parseInt(g.controls[p].name.substring(14));if(d>0){addFilter("AND",0)}}}}for(var p in c){if(p.indexOf("and_or_0_")!=-1||p.indexOf("scope_0_")!=-1||p.indexOf("field_0_")!=-1||p.indexOf("condition_0_")!=-1){$("#"+p).val(c[p]).trigger("change")}else{$("#"+p).val(c[p])}}}}}}if(r=="CUSTOM"&&e!=""&&l!=""){$("#div_custom_dates").css("display","");getMinMaxDate(0,e,l,"QUERY")}if(n.trim()!=""){$("#div_report_content_placeholder").css("display","none");$("#div_report_content_canvases").css("display","");$("#div_report").css("display","");$("#div_report").css("width",i_workspace_width+"px");$("#div_sidebar_visualizations").css("display","none");$("#div_sidebar_visualizations_report").css("display","");showReportSidebar("report");var a=g.reportfields.length;for(var f=0;f<a;f++){if(g.reportfields[f].indexOf("p_0_0_")==0){var q=$("<option/>");var h=g.reportfields[f].replace(/^p_\d+_\d+_/g,"");q.text(h);q.attr("value",g.reportfields[f]);$("#s_report_field").append(q)}}var m=JSON.parse(o);drawReportVisuals(m,"");assignAbsolutes();$.unblockUI()}else{setTimeout(function(){loadHistoryReport(o)},1000)}};var margin_compare,width_compare,height_compare,i_compare,duration_compare,root_compare,tree_compare,diagonal_compare,svg_compare,zoom_compare,direction_compare;var i_iteration_compare=0;var i_count_total_compare_a=0;var i_count_total_compare_b=0;var i_slider_compare_value=1;var i_slider_compare_min=1;var i_slider_compare_max=100;loadHistoryQueryCompare=function(p,t){var k=$("#s_event").html();var s=JSON.parse(p);s_tstampcode=s.tstampcode;i_count_total_compare_a=parseInt(s.totalcounta);i_count_total_compare_b=parseInt(s.totalcountb);i_slider_tree_value=0;i_slider_tree_min=0;i_slider_tree_max=100;i_min_tree_real=-1;i_max_tree_real=-1;s_mode_tree_slider="percentage";var q=[];$("#cb_drops").prop("checked",false);$("#cb_eoi_dedupe").prop("checked",false);$("#cb_filter").prop("checked",false);$("#cb_first_match_compare").prop("checked",false);$("#cb_drops_compare").prop("checked",false);$("#cb_eoi_dedupe_compare").prop("checked",false);$("#cb_filter_compare").prop("checked",false);var n="";var j="";var b="";var f="";var d="";var r="";for(var e in s.controls){if(s.controls.hasOwnProperty(e)){if(s.controls[e].name=="s_direction"){s_direction=s.controls[e].value;$("#s_direction").val(s_direction).trigger("change");s_direction_set=$("#s_direction").val()}if(s.controls[e].name=="s_eoi_setting"){$("#s_eoi_setting").val(s.controls[e].value).trigger("change")}if(s.controls[e].name=="t_event"){$("#t_event").val(s.controls[e].value)}if(s.controls[e].name=="s_event"){$("#s_event").val(s.controls[e].value).trigger("change")}if(s.controls[e].name=="cb_first_match"){$("#cb_first_match").val(s.controls[e].value).trigger("change")}if(s.controls[e].name=="s_eoi_setting_compare"){$("#s_eoi_setting_compare").val(s.controls[e].value).trigger("change")}if(s.controls[e].name=="t_event_compare"){$("#t_event_compare").val(s.controls[e].value)}if(s.controls[e].name=="s_event_compare"){$("#s_event_compare").val(s.controls[e].value).trigger("change")}if(s.controls[e].name=="cb_first_match_compare"){$("#cb_first_match_compare").val(s.controls[e].value).trigger("change")}if(s.controls[e].name=="cb_drops"){if(s.controls[e].value=="1"){$("#cb_drops").prop("checked",true)}}if(s.controls[e].name=="cb_drops_compare"){if(s.controls[e].value=="1"){$("#cb_drops_compare").prop("checked",true)}}if(s.controls[e].name=="s_max_events"){$("#s_max_events").val(s.controls[e].value).trigger("change")}if(s.controls[e].name=="s_result_set"){$("#s_result_set").val(s.controls[e].value).trigger("change")}if(s.controls[e].name=="s_time_window"){b=s.controls[e].value;recreateTimeWindowSelect(b,"QUERY")}if(s.controls[e].name=="s_time_window_compare"){r=s.controls[e].value;recreateTimeWindowSelect(b,"COMPARE")}if(b=="CUSTOM"){if(s.controls[e].name=="dp_start"){n=s.controls[e].value}if(s.controls[e].name=="dp_end"){j=s.controls[e].value}}if(r=="CUSTOM"){if(s.controls[e].name=="dp_start_compare"){f=s.controls[e].value}if(s.controls[e].name=="dp_end_compare"){d=s.controls[e].value}}if(s.controls[e].name=="s_dedupe"){$("#s_dedupe").val(s.controls[e].value).trigger("change")}if(s.controls[e].name=="s_dedupe_compare"){$("#s_dedupe_compare").val(s.controls[e].value).trigger("change")}if(s.controls[e].name=="cb_eoi_dedupe"){if(s.controls[e].value=="1"){$("#cb_eoi_dedupe").prop("checked",true)}}if(s.controls[e].name=="cb_eoi_dedupe_compare"){if(s.controls[e].value=="1"){$("#cb_eoi_dedupe_compare").prop("checked",true)}}if(s.controls[e].name=="cb_filter"){if(s.controls[e].value=="on"){$("#cb_filter").prop("checked",true);toggleFilter();var m=0;for(var u in s.controls){if(s.controls.hasOwnProperty(u)){if(s.controls[u].name.indexOf("and_or_0_")!=-1||s.controls[u].name.indexOf("open_parens_0_")!=-1||s.controls[u].name.indexOf("scope_0_")!=-1||s.controls[u].name.indexOf("field_0_")!=-1||s.controls[u].name.indexOf("condition_0_")!=-1||s.controls[u].name.indexOf("value_0_")!=-1||s.controls[u].name.indexOf("close_parens_0_")!=-1){q[s.controls[u].name]=s.controls[u].value}if(s.controls[u].name.indexOf("open_parens_0_")!=-1){var c=parseInt(s.controls[u].name.substring(14));if(c>0&&$("#open_parens_0_"+c).length==0){addFilter("AND",0)}}}}for(var u in q){if(u.indexOf("and_or_0_")!=-1||u.indexOf("scope_0_")!=-1||u.indexOf("field_0_")!=-1||u.indexOf("condition_0_")!=-1){$("#"+u).val(q[u]).trigger("change")}else{$("#"+u).val(q[u])}}}}if(s.controls[e].name=="cb_filter_compare"){if(s.controls[e].value=="on"){$("#cb_filter_compare").prop("checked",true);toggleFilterCompare();var m=0;for(var u in s.controls){if(s.controls.hasOwnProperty(u)){if(s.controls[u].name.indexOf("and_or_compare_0_")!=-1||s.controls[u].name.indexOf("open_parens_compare_0_")!=-1||s.controls[u].name.indexOf("scope_compare_0_")!=-1||s.controls[u].name.indexOf("field_compare_0_")!=-1||s.controls[u].name.indexOf("condition_compare_0_")!=-1||s.controls[u].name.indexOf("value_compare_0_")!=-1||s.controls[u].name.indexOf("close_parens_compare_0_")!=-1){q[s.controls[u].name]=s.controls[u].value}if(s.controls[u].name.indexOf("open_parens_compare_0_")!=-1){var c=parseInt(s.controls[u].name.substring(22));if(c>0&&$("#open_parens_compare_0_"+c).length==0){addFilterCompare("AND",0)}}}}for(var u in q){if(u.indexOf("and_or_compare_0_")!=-1||u.indexOf("scope_compare_0_")!=-1||u.indexOf("field_compare_0_")!=-1||u.indexOf("condition_compare_0_")!=-1){$("#"+u).val(q[u]).trigger("change")}else{$("#"+u).val(q[u])}}}}}}if(b=="CUSTOM"&&n!=""&&j!=""){$("#div_custom_dates").css("display","");getMinMaxDate(0,n,j,"QUERY")}if(r=="CUSTOM"&&f!=""&&d!=""){$("#div_custom_dates_compare").css("display","");getMinMaxDate(0,f,d,"COMPARE")}if(s==null||s.totalcounta==null){showCompareSidebar(s_selected);compareToggle("COMPARISON");blockQueryError("");b_idle=1}else{i_count_total_compare_a=parseInt(s.totalcounta);i_count_total_compare_b=parseInt(s.totalcountb);var q=[];var a=1;var l=495;var h=0;if(parseInt(s.topcounta)>0){h=(l/parseInt(s.topcounta))}var g=0;if(parseInt(s.topcountb)>0){g=(l/parseInt(s.topcountb))}$("#t_data_compare_list tbody").empty();var o="";$.each(s.topn,function(w,B){var v=parseInt(B[0]);var C=parseInt(B[1]);var A=parseInt(B[2]);var z=parseInt(B[3]);var D=B[4].replace("|||"," / ");var y=(parseInt((v*h))-3);var x=(parseInt((C*g))-3);if(A==-1){A="NA"}if(z==-1){z="NA"}o+="<tr><td>"+A+"</td><td>"+z+'<td style="color: #333333; height: 46px;"><div style="position: absolute; margin-left: -4px; margin-top: -20px; height: 20px; width: '+y+'px; background: #D4E6F1;"></div><div style="position: absolute; font-size: 10px; width: '+(l-20)+'px; margin-top: -20px; line-height: 20px; z-index: 10;">'+D+'</div><div style="position: absolute; margin-left: -4px; margin-top: 1px; height: 20px; width: '+x+'px; background: #CCCCCC;"></div></td><td>'+v+"</td><td>"+C+"</td></tr>";a++});$("#t_data_compare_list tbody").html(o);$("#t_data_compare_list").trigger("update");i_slider_tree_value=0;i_slider_tree_min=0;i_slider_tree_max=100;i_min_tree_real=-1;i_max_tree_real=-1;s_mode_tree_slider="percentage";$("#r_compare_filter_percent").prop("checked",true);$("#r_compare_filter_percent").change();i_iteration_compare=0;direction_compare=s_direction;margin_compare={top:0,right:0,bottom:0,left:0},width_compare=parseInt($("#div_tree_compare").css("width"))-margin_compare.right-margin_compare.left,height_compare=($(window).outerHeight(true)-200-100);i_compare=0,duration_compare=750,root_compare;tree_compare=d3.layout.tree().size([height_compare,width_compare]);diagonal_compare=d3.svg.diagonal().projection(function(v){return[v.y,v.x]});d3.select("#div_tree_container_compare").on("mouseleave",mouseleave);zoom_compare=d3.behavior.zoom();svg_compare=d3.select("#div_tree_container_compare").append("svg").attr("width",width_compare+margin_compare.right+margin_compare.left).attr("height",height_compare+margin_compare.top+margin_compare.bottom).attr("id","svg_tree_container_compare").call(zoom_compare.on("zoom",function(){svg_compare.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")})).append("g").attr("transform","translate("+margin_compare.left+","+margin_compare.top+")");resetZoomPanCompare();$("#div_store_tree").html(JSON.stringify(s.tree));if(direction_compare=="startevent"){root_compare=s.tree;root_compare.x0=height_compare/2;root_compare.y0=0}else{if(direction_compare=="endevent"){root_compare=s.tree;root_compare.x0=height_compare/2;root_compare.y0=width_compare}else{if(direction_compare=="throughevent"){root_compare=s.tree;root_compare.x0=height_compare/2;root_compare.y0=width_compare}}}root_compare.children.forEach(collapse);$("#div_sidebar_visualizations").css("display","none");$("#div_sidebar_visualizations_compare").css("display","");s_selected="paths_compare";showCompareSidebar(s_selected);if(i_controls_toggle==0){controlsToggle()}compareToggle("COMPARISON");expandDominantCompare();buildCompareFilter(s_mode_tree_slider);assignAbsolutes();$.unblockUI();b_idle=1;buildCompareSlider("percentage")}};buildCompareSlider=function(b){if(b=="percentage"){var a=1;$("#div_amount_compare").html(a+"%");compareHighlight(a,b);$("#slider-range-compare").slider({value:1,min:i_slider_compare_min,max:i_slider_compare_max,step:1,create:function(){compareHighlight(a,b)},slide:function(c,d){i_slider_compare_value=$(this).slider("value");$("#div_amount_compare").html(i_slider_compare_value+"%");compareHighlight(i_slider_compare_value,b)},stop:function(d,c){i_slider_compare_value=$(this).slider("value");$("#div_amount_compare").html(i_slider_compare_value+"%");compareHighlight(i_slider_compare_value,b)}})}else{if(b=="real"){var a=1;$("#div_amount_compare").html(a);compareHighlight(a,b);$("#slider-range-compare").slider({value:a,min:i_min_difference,max:i_max_difference,step:1,create:function(){compareHighlight(a,b)},slide:function(c,d){i_slider_compare_value=$(this).slider("value");$("#div_amount_compare").html(i_slider_compare_value);compareHighlight(i_slider_compare_value,b)},stop:function(d,c){i_slider_compare_value=$(this).slider("value");$("#div_amount_compare").html(i_slider_compare_value);compareHighlight(i_slider_compare_value,b)}})}}};compareHighlight=function(a,b){$(".link3").each(function(){var c=0;if(b=="percentage"){c=parseInt($(this).attr("pct"));if(c>=a){$(this).css("opacity","0.5")}else{$(this).css("opacity","0")}}else{if(b=="real"){c=parseInt($(this).attr("cnt"));if(c>=a){$(this).css("opacity","0.5")}else{$(this).css("opacity","0")}}}})};setNodeIndex=function(a){$("#h_node_idx").val(a)};setSearchTerm=function(a){$("#t_search_term").val(a)};setUniqueId=function(a){$("#t_unique_id").val(a)};viewTextRecords=function(b){if(b=="text"){$("#div_text_records_view_tokens").css("display","none");$("#div_text_records_view_text").css("display","")}else{if(b=="token"){$("#div_text_records_view_text").css("display","none");$("#div_text_records_view_tokens").css("display","");var a=JSON.parse($("#div_history_text_records").html());setTimeout(function(){showWordCloud(a.wc0[$("#h_node_idx").val()])},200);refreshTableSorter()}}};loadHistoryTextRecordsFilter=function(o,p,l){if(l=="current"){if($("#div_text_records_view_tokens").length>0&&$("#div_text_records_view_text").css("display")=="none"){l="token"}else{l="text"}}var m=$("#s_event").html();if(o==""){o=$("#div_history_text_records").html()}var f=JSON.parse(o);var k=$("#t_unique_id").val();var g=$("#t_search_term").val();var n=$("#h_node_idx").val();var b=[];$("#cb_drops").prop("checked",false);$("#cb_eoi_dedupe").prop("checked",false);$("#cb_filter").prop("checked",false);var e="";var j="";var r="";for(var a in f.controls){if(f.controls.hasOwnProperty(a)){if(f.controls[a].name=="s_direction"){s_direction=f.controls[a].value;$("#s_direction").val(s_direction).trigger("change");s_direction_set=$("#s_direction").val()}if(f.controls[a].name=="s_eoi_setting"){$("#s_eoi_setting").val(f.controls[a].value).trigger("change")}if(f.controls[a].name=="t_event"){$("#t_event").val(f.controls[a].value)}if(f.controls[a].name=="s_event"){$("#s_event").val(f.controls[a].value).trigger("change")}if(f.controls[a].name=="cb_first_match"){$("#cb_first_match").val(f.controls[a].value).trigger("change")}if(f.controls[a].name=="cb_drops"){if(f.controls[a].value=="1"){$("#cb_drops").prop("checked",true)}}if(f.controls[a].name=="s_max_events"){$("#s_max_events").val(f.controls[a].value).trigger("change")}if(f.controls[a].name=="s_result_set"){$("#s_result_set").val(f.controls[a].value).trigger("change")}if(f.controls[a].name=="s_time_window"){r=f.controls[a].value;recreateTimeWindowSelect(r,"QUERY")}if(r=="CUSTOM"){if(f.controls[a].name=="dp_start"){e=f.controls[a].value}if(f.controls[a].name=="dp_end"){j=f.controls[a].value}}if(f.controls[a].name=="s_dedupe"){$("#s_dedupe").val(f.controls[a].value).trigger("change")}if(f.controls[a].name=="cb_eoi_dedupe"){if(f.controls[a].value=="1"){$("#cb_eoi_dedupe").prop("checked",true)}}if(f.controls[a].name=="cb_filter"){if(f.controls[a].value=="on"){$("#cb_filter").prop("checked",true);toggleFilter();var h=0;for(var q in f.controls){if(f.controls.hasOwnProperty(q)){if(f.controls[q].name.indexOf("and_or_0_")!=-1||f.controls[q].name.indexOf("open_parens_0_")!=-1||f.controls[q].name.indexOf("scope_0_")!=-1||f.controls[q].name.indexOf("field_0_")!=-1||f.controls[q].name.indexOf("condition_0_")!=-1||f.controls[q].name.indexOf("value_0_")!=-1||f.controls[q].name.indexOf("close_parens_0_")!=-1){b[f.controls[q].name]=f.controls[q].value}if(f.controls[q].name.indexOf("open_parens_0_")!=-1){var c=parseInt(f.controls[q].name.substring(14));if(c>0){addFilter("AND",0)}}}}for(var q in b){if(q.indexOf("and_or_0_")!=-1||q.indexOf("scope_0_")!=-1||q.indexOf("field_0_")!=-1||q.indexOf("condition_0_")!=-1){$("#"+q).val(b[q]).trigger("change")}else{$("#"+q).val(b[q])}}}}}}if(r=="CUSTOM"&&e!=""&&j!=""){$("#div_custom_dates").css("display","");getMinMaxDate(0,e,j,"QUERY")}if(m.trim()!=""){var d=$.get("/tcj/aa",{a:"getHistoryTextRecords",tsc:p,uid:k,st:g,ndx:n,v:l},function(t){$("#div_text_content").html(t);$("#div_text").css("display","");$("#div_text").css("width",i_workspace_width+"px");$("#div_sidebar_visualizations").css("display","none");$("#div_sidebar_visualizations_text").css("display","");showTextSidebar("text");refreshTableSorter();if(l=="token"){var s=JSON.parse($("#div_history_text_records").html());showWordCloud(s.wc0[$("#h_node_idx").val()]);refreshTableSorter()}if(i_controls_toggle==0){controlsToggle()}$.unblockUI()},"html")}else{setTimeout(function(){loadHistoryTextRecords(o)},1000)}};loadHistoryTextRecords=function(h){var g=$("#s_event").html();var e=JSON.parse(h);var b=[];$("#cb_drops").prop("checked",false);$("#cb_eoi_dedupe").prop("checked",false);$("#cb_filter").prop("checked",false);for(var a in e.controls){if(e.controls.hasOwnProperty(a)){if(e.controls[a].name=="s_direction"){s_direction=e.controls[a].value;$("#s_direction").val(s_direction).trigger("change");s_direction_set=$("#s_direction").val()}if(e.controls[a].name=="s_eoi_setting"){$("#s_eoi_setting").val(e.controls[a].value).trigger("change")}if(e.controls[a].name=="t_event"){$("#t_event").val(e.controls[a].value)}if(e.controls[a].name=="s_event"){$("#s_event").val(e.controls[a].value).trigger("change")}if(e.controls[a].name=="cb_first_match"){$("#cb_first_match").val(e.controls[a].value).trigger("change")}if(e.controls[a].name=="cb_drops"){if(e.controls[a].value=="1"){$("#cb_drops").prop("checked",true)}}if(e.controls[a].name=="s_max_events"){$("#s_max_events").val(e.controls[a].value).trigger("change")}if(e.controls[a].name=="s_result_set"){$("#s_result_set").val(e.controls[a].value).trigger("change")}if(e.controls[a].name=="s_time_window"){s_time_window=e.controls[a].value;recreateTimeWindowSelect(s_time_window,"QUERY")}if(s_time_window=="CUSTOM"){if(e.controls[a].name=="dp_start"){s_start_date=e.controls[a].value}if(e.controls[a].name=="dp_end"){s_end_date=e.controls[a].value}}if(e.controls[a].name=="s_dedupe"){$("#s_dedupe").val(e.controls[a].value).trigger("change")}if(e.controls[a].name=="cb_eoi_dedupe"){if(e.controls[a].value=="1"){$("#cb_eoi_dedupe").prop("checked",true)}}if(e.controls[a].name=="cb_filter"){if(e.controls[a].value=="on"){$("#cb_filter").prop("checked",true);toggleFilter();var f=0;for(var j in e.controls){if(e.controls.hasOwnProperty(j)){if(e.controls[j].name.indexOf("and_or_0_")!=-1||e.controls[j].name.indexOf("open_parens_0_")!=-1||e.controls[j].name.indexOf("scope_0_")!=-1||e.controls[j].name.indexOf("field_0_")!=-1||e.controls[j].name.indexOf("condition_0_")!=-1||e.controls[j].name.indexOf("value_0_")!=-1||e.controls[j].name.indexOf("close_parens_0_")!=-1){b[e.controls[j].name]=e.controls[j].value}if(e.controls[j].name.indexOf("open_parens_0_")!=-1){var c=parseInt(e.controls[j].name.substring(14));if(c>0){addFilter("AND",0)}}}}for(var j in b){if(j.indexOf("and_or_0_")!=-1||j.indexOf("scope_0_")!=-1||j.indexOf("field_0_")!=-1||j.indexOf("condition_0_")!=-1){$("#"+j).val(b[j]).trigger("change")}else{$("#"+j).val(b[j])}}}}}}if(s_time_window=="CUSTOM"&&s_start_date!=""&&s_end_date!=""){$("#div_custom_dates").css("display","");getMinMaxDate(0,s_start_date,s_end_date,"QUERY")}if(g.trim()!=""){var d=$.get("/tcj/aa",{a:"getHistoryTextRecords",h:h},function(k){$("#div_text_content").html(k);$("#div_text").css("display","");$("#div_text").css("width",i_workspace_width+"px");$("#div_sidebar_visualizations").css("display","none");$("#div_sidebar_visualizations_text").css("display","");showTextSidebar("text");refreshTableSorter();if(i_controls_toggle==0){controlsToggle()}$.unblockUI()},"html")}else{setTimeout(function(){loadHistoryTextRecords(h)},1000)}};showJStore=function(){$("#div_tree_container").css("width","300px")};runTree=function(c,d){$("#div_sidebar_visualizations_compare").css("display","none");$("#div_sidebar_visualizations").css("display","");i_iteration=0;direction=d;margin={top:0,right:60,bottom:0,left:60},width=parseInt($("#div_tree").css("width"))-margin.right-margin.left,height=($(window).outerHeight(true)-300);i=0,duration=750;var a=parseInt($("#div_tree").css("width"));tree=d3.layout.tree().size([height,a]);diagonal=d3.svg.diagonal().projection(function(f){return[f.y,f.x]});zoom=d3.behavior.zoom();svg=d3.select("#div_tree_container").append("svg").attr("width",a).attr("height",height+margin.top+margin.bottom).attr("id","svg_tree_container").call(zoom.on("zoom",function(){svg.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")})).append("g").attr("transform","translate("+margin.left+","+margin.top+")");resetZoomPan();i_count_total=parseInt(c.totalcount);if(c==null){alert("Sorry, this query produced zero paths.");$.unblockUI();b_idle=1}else{$("#div_store_tree").html(JSON.stringify(c.tree));root=c.tree;if(direction=="startevent"){root.x0=height/2;root.y0=0}else{if(direction=="endevent"){root.x0=height/2;root.y0=a}else{if(direction=="throughevent"){root.x0=height/2;root.y0=a}}}i_slider_tree_value=0;i_slider_tree_min=0;i_slider_tree_max=100;i_min_tree_real=-1;i_max_tree_real=-1;s_mode_tree_slider="percentage";$("#r_amount_tree_percent").prop("checked",true);$("#r_amount_tree_percent").change();var e="";e=JSON.stringify(c.sankeyflow);e=e.substring(1,e.length-1).trim();$("#div_store_flow").html(e);var b=JSON.parse($("#div_store_flow").html());drawSankey(b);setTimeout(function(){sankeyColors();i_sankey_slider_low=$("#slider-range-flow").slider("values",0),i_sankey_slider_high=$("#slider-range-flow").slider("values",1);sankeySliderEngage()},0);$("#div_flow").css("width",i_workspace_width+"px");setTimeout(function(){$("#div_flow").css("display","")},50);assignAbsolutes();$.unblockUI()}d3.select(self.frameElement).style("height","100%")};var i_slider_tree_value=0;var i_slider_tree_min=0;var i_slider_tree_max=100;var i_min_tree_real=-1;var i_max_tree_real=-1;var s_mode_tree_slider="percentage";buildTreeFilter=function(a){s_mode_tree_slider=a;if(s_mode_tree_slider=="percentage"){$("#t_tree_filter_min").val(i_slider_tree_min);$("#t_tree_filter_max").val(i_slider_tree_max)}else{if(s_mode_tree_slider=="real"){$("#t_tree_filter_min").val(i_min_tree_real);$("#t_tree_filter_max").val(i_max_tree_real)}}};buildTree=function(){resetTargetPaths();i_min_tree=$("#t_tree_filter_min").val();i_max_tree=$("#t_tree_filter_max").val();root=null;var a=JSON.parse($("#div_store_tree").html());root=a;traverse(root,"normal");wipeNodes(root);if(direction=="startevent"){root.x0=height/2;root.y0=0}else{if(direction=="endevent"){root.x0=height/2;root.y0=width}else{if(direction=="throughevent"){root.x0=height/2;root.y0=width}}}root.children.forEach(collapse);expandDominant()};buildCompareFilter=function(a){s_mode_tree_slider=a;if(s_mode_tree_slider=="percentage"){$("#t_compare_filter_min").val(i_slider_tree_min);$("#t_compare_filter_max").val(i_slider_tree_max)}else{if(s_mode_tree_slider=="real"){$("#t_compare_filter_min").val(i_min_tree_real);$("#t_compare_filter_max").val(i_max_tree_real)}}};buildCompare=function(){i_min_tree=$("#t_compare_filter_min").val();i_max_tree=$("#t_compare_filter_max").val();root_compare=null;var a=JSON.parse($("#div_store_tree").html());root_compare=a;traverse(root_compare,"compare");wipeNodes(root_compare);if(direction=="startevent"){root_compare.x0=height/2;root_compare.y0=0}else{if(direction=="endevent"){root_compare.x0=height/2;root_compare.y0=width}else{if(direction=="throughevent"){root_compare.x0=height/2;root_compare.y0=width}}}root_compare.children.forEach(collapse);expandDominantCompare()};var i_slider_flow_value=0;var i_slider_flow_min=0;var i_slider_flow_max=100;var i_min_flow_real=-1;var i_max_flow_real=-1;var s_mode_flow_slider="percentage";buildFlowFilter=function(a){s_mode_flow_slider=a;if(s_mode_flow_slider=="percentage"){$("#t_flow_filter_min").val(i_slider_flow_min)}else{if(s_mode_flow_slider=="real"){$("#t_flow_filter_min").val(i_min_flow_real)}}};buildFlow=function(){i_min_flow=$("#t_flow_filter_min").val();i_max_flow=$("#t_flow_filter_max").val();var a=JSON.parse($("#div_store_flow").html());traverseFlow(a);drawSankey(a)};function clearNodes(a){a.selected=0;if(a.children){a.children.forEach(clearNodes)}else{if(a._children){a._children.forEach(clearNodes)}}}function collapse(a){if(a.children){a._children=a.children;a._children.forEach(collapse);a.children=null}}function expand(b){var a=(b.children)?b.children:b._children;if(b._children){b.children=b._children;b._children=null}if(a){a.forEach(expand)}}function expandAll(){expand(root);update(root)}function expandAllCompare(){expand(root_compare);update_compare(root_compare)}function expandDominantPath(f,g){var b=new RegExp("^link-"+g+"-.*");var a=null;var e=0;svg.selectAll("path.link").each(function(j,h){if(b.test(this.id)){if(parseInt(j.target.size)>e){e=j.target.size;a=j.target}}});f=a;if(f!=null){var c=(f.children)?f.children:f._children;if(f._children){f.children=f._children;f._children=null}update(root);expandDominantPath(f,f.id)}}function expandDominant(){update(root);var a=root.id;expandDominantPath(root,a)}function expandDominantPathCompare(f,g){var b=new RegExp("^link-"+g+"-.*");var a=null;var e=0;svg_compare.selectAll("path.link").each(function(h,j){if(b.test(this.id)){if(parseInt(h.target.sizea)>e){e=h.target.sizea;a=h.target}}});f=a;if(f!=null){var c=(f.children)?f.children:f._children;if(f._children){f.children=f._children;f._children=null}update_compare(root_compare);expandDominantPathCompare(f,f.id)}}function expandDominantCompare(){update_compare(root_compare);var a=root_compare.id;expandDominantPathCompare(root_compare,a)}function collapseAllCompare(){root_compare.children.forEach(collapse);update_compare(root_compare)}var i_min_difference=-1;var i_max_difference=-1;function update_compare(a){i_iteration_compare++;var c=tree_compare.nodes(root_compare).reverse(),o=tree_compare.links(c);var m=parseInt($("#s_max_events").val());var e=180;e=400;var b=parseInt($("#div_tree").css("width"));if(direction_compare=="startevent"){c.forEach(function(q){q.y=(((b-400)/m)*q.depth)+200})}else{if(direction_compare=="endevent"){c.forEach(function(q){q.y=(b-((b-400)/m)*q.depth)-200})}else{if(direction_compare=="throughevent"){c.forEach(function(q){q.y=(b-150)-(q.depth*e)})}}}var d=svg_compare.selectAll("g.node").data(c,function(q){return q.id||(q.id=++i_compare)});var g=d.enter().append("g").attr("class","node").attr("transform",function(q){return"translate("+a.y0+","+a.x0+")"}).attr("id",function(q){nodeindex++;return"node-"+nodeindex});var f=svg_compare.append("svg:defs");f.append("svg:pattern").attr("id","pencil").attr("x",0).attr("y",0).attr("width",25).attr("height",25).append("svg:image").attr("xlink:href","/tcj/images/letters_orange.png").attr("x",0).attr("y",0).attr("width",20).attr("height",20);g.append("circle").attr("r",0.000001).attr("id",function(q){nodeindex++;return"node-"+nodeindex}).attr("nodename",function(q){return q.name}).attr("edgemap",function(q){return buildEdgeMap(q)}).attr("edgeidmap",function(q){return buildEdgeIdMap(q)}).attr("class","context-menu-compare box menu-1").style("fill",function(q){return q._children?"#D4E6F1":"#fff"}).on("click",click_compare);if(direction_compare=="startevent"){g.append("text").each(function(t){if(t.name.indexOf("|||")==-1){d3.select(this).append("tspan").text(t.name).attr("x",function(u){return u.children||u._children?-13:13}).attr("dy",".35em").attr("text-anchor",function(u){return u.children||u._children?"end":"start"})}else{var r=t.name.split("|||");for(var q=0;q<r.length;q++){var s=r[q];if(q<(r.length-1)){s=s+" /"}d3.select(this).append("tspan").text(s).attr("x",function(u){return u.children||u._children?-13:13}).attr("dy",q+"em").attr("text-anchor",function(u){return u.children||u._children?"end":"start"})}}})}else{if(direction_compare=="endevent"){g.append("text").each(function(t){if(t.name.indexOf("|||")==-1){d3.select(this).append("tspan").text(t.name).attr("x",function(u){return u.children||u._children?13:-13}).attr("dy",".35em").attr("text-anchor",function(u){return u.children||u._children?"start":"end"})}else{var r=t.name.split("|||");for(var q=0;q<r.length;q++){var s=r[q];if(q<(r.length-1)){s=s+" /"}d3.select(this).append("tspan").text(s).attr("x",function(u){return u.children||u._children?13:-13}).attr("dy",q+"em").attr("text-anchor",function(u){return u.children||u._children?"start":"end"})}}})}else{if(direction_compare=="throughevent"){g.append("text").attr("x",function(q){return q.children||q._children?13:-13}).attr("dy",".35em").attr("text-anchor",function(q){return q.children||q._children?"start":"end"}).text(function(q){return q.name}).style("fill-opacity",0.000001)}}}var h=d.transition().duration(duration_compare).attr("transform",function(q){return"translate("+q.y+","+q.x+")"});h.select("circle").attr("r",10).style("fill",function(q){return q._children?"#E5F3FF":"#fff"});h.select("text").style("fill-opacity",1);var n=d.exit().transition().duration(duration_compare).attr("transform",function(q){return"translate("+a.y+","+a.x+")"}).remove();n.select("circle").attr("r",0.000001);n.select("text").style("fill-opacity",0.000001);var l=svg_compare.selectAll("path.link").data(o,function(q){return q.target.id});$(".link2").each(function(){$(this).remove()});$(".link3").each(function(){$(this).remove()});var p=d3.select("div.tooltip_compare");l.enter().insert("path","g").attr("id",function(q){return"link-"+q.source.id+"-"+q.target.id}).attr("class","link").attr("title",function(q){return(q.target.sizea)}).style("stroke-width",function(q){if(i_max_difference==-1||Math.abs(q.target.sizea-q.target.sizeb)>i_max_difference){i_max_difference=Math.abs(q.target.sizea-q.target.sizeb)}if(i_min_difference==-1||Math.abs(q.target.sizea-q.target.sizeb)<i_min_difference){i_min_difference=Math.abs(q.target.sizea-q.target.sizeb)}if(i_min_difference==0){i_min_difference=1}if(i_max_tree_real==-1||q.target.sizea>i_max_tree_real||q.target.sizeb>i_max_tree_real){if(q.target.sizea>q.target.sizeb){i_max_tree_real=q.target.sizea}else{i_max_tree_real=q.target.sizeb}}if(i_min_tree_real==-1||q.target.sizea<i_min_tree_real||q.target.sizeb<i_min_tree_real){if(q.target.sizea<q.target.sizeb){i_min_tree_real=q.target.sizea}else{i_min_tree_real=q.target.sizeb}}var r=0;if(q.target.sizea==0){r=0}else{r=q.target.widtha}return r}).attr("msg",function(q){return q.target.sizea+" ("+Math.round(((q.target.sizea/i_count_total_compare_a)*100))+"%)"}).on("mouseover",function(q){$("#div_tooltip_compare_a").html(q.target.sizea+" ("+Math.round(((q.target.sizea/i_count_total_compare_a)*100))+"%)");$("#div_tooltip_compare_b").html(q.target.sizeb+" ("+Math.round(((q.target.sizeb/i_count_total_compare_b)*100))+"%)");if($("#div_tooltip_compare_a").width()>$("#div_tooltip_compare_b").width()){$("#div_tooltip_compare_b").css("width",$("#div_tooltip_compare_a").width()+"px")}else{$("#div_tooltip_compare_a").css("width",$("#div_tooltip_compare_b").width()+"px")}return p.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px").style("visibility","visible")}).on("mousemove",function(){if($("#div_tooltip_compare_a").width()>$("#div_tooltip_compare_b").width()){$("#div_tooltip_compare_b").css("width",$("#div_tooltip_compare_a").width()+"px")}else{$("#div_tooltip_compare_a").css("width",$("#div_tooltip_compare_b").width()+"px")}return p.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px")}).on("mouseout",function(){return p.style("visibility","hidden")}).attr("d",function(r){var q={x:a.x0,y:a.y0};return diagonal_compare({source:q,target:q})});l.transition().duration(duration_compare).attr("d",diagonal_compare);l.exit().transition().duration(duration_compare).attr("d",function(r){var q={x:a.x,y:a.y};return diagonal_compare({source:q,target:q})}).remove();var k=svg_compare.selectAll("g.link").data(o,function(q){return q.target.id});k.enter().insert("path","g").attr("id",function(q){return"link2-"+q.source.id+"-"+q.target.id}).attr("class","link").style("stroke-width",function(q){return(q.target.widthb)}).style("stroke","#000000").style("opacity",0).on("mouseover",function(q){$(this).css("stroke","#336699");$("#div_tooltip_compare_a").html(q.target.sizea+" ("+Math.round(((q.target.sizea/i_count_total_compare_a)*100))+"%)");$("#div_tooltip_compare_b").html(q.target.sizeb+" ("+Math.round(((q.target.sizeb/i_count_total_compare_b)*100))+"%)");if($("#div_tooltip_compare_a").width()>$("#div_tooltip_compare_b").width()){$("#div_tooltip_compare_b").css("width",$("#div_tooltip_compare_a").width()+"px")}else{$("#div_tooltip_compare_a").css("width",$("#div_tooltip_compare_b").width()+"px")}return p.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px").style("visibility","visible")}).on("mousemove",function(){$(this).css("stroke","#336699");if($("#div_tooltip_compare_a").width()>$("#div_tooltip_compare_b").width()){$("#div_tooltip_compare_b").css("width",$("#div_tooltip_compare_a").width()+"px")}else{$("#div_tooltip_compare_a").css("width",$("#div_tooltip_compare_b").width()+"px")}return p.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px")}).on("mouseout",function(){$(this).css("stroke","#000000");return p.style("visibility","hidden")}).attr("d",function(r){var q={x:a.x0,y:a.y0};return diagonal_compare({source:q,target:q})});k.transition().duration(duration_compare).style("stroke","#333333").attr("d",diagonal_compare).style("stroke-width",function(r){var q=0;if(r.target.sizeb==0){q=0}else{q=r.target.widthb}return q}).transition().duration(1).attr("class","link2").style("opacity","0.3");k.exit().transition().duration(duration_compare).attr("d",function(r){var q={x:a.x,y:a.y};return diagonal_compare({source:q,target:q})}).remove();var j=svg_compare.selectAll("g.link").data(o,function(q){return q.target.id});j.enter().insert("path","g").attr("id",function(q){return"link3-"+q.source.id+"-"+q.target.id}).attr("class","link").style("stroke","#FF5750").style("opacity",0).on("mouseover",function(r){var q='<div id="div_tooltip_compare_a" style="float: left; padding-top: 4px; padding-bottom: 4px; width: 100%; background: #D4E6F1; text-align: center; color: #333333; white-space: nowrap;">';q+="&nbsp;&nbsp;"+r.target.sizea.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" ("+Math.round(((r.target.sizea/i_count_total_compare_a)*100)||0)+"%)&nbsp;&nbsp;";q+="</div>";q+='<div style="clear: both; height: 0px; width: 1px;"></div>';q+='<div id="div_tooltip_compare_b" style="float: left; padding-top: 4px; padding-bottom: 4px; width: 100%; background: #333333; text-align: center; color: #eeeeee; white-space: nowrap;">';q+="&nbsp;&nbsp;"+r.target.sizeb.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" ("+Math.round(((r.target.sizeb/i_count_total_compare_b)*100)||0)+"%)&nbsp;&nbsp;";q+="</div>";$("#div_tooltip_compare").html(q);return p.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px").style("visibility","visible")}).on("mousemove",function(){return p.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px")}).on("mouseout",function(){return p.style("visibility","hidden")}).attr("d",function(r){var q={x:a.x0,y:a.y0};return diagonal_compare({source:q,target:q})});j.transition().duration(duration_compare).style("stroke","#FF5750").style("stroke-width",function(u){var r=u.target.sizea;var q=u.target.sizeb;var v=u.target.widtha;var t=u.target.widthb;var s=0;if(v>t){s=v}else{s=t}return s}).attr("d",diagonal_compare).transition().duration(1).attr("class","link3").attr("cnt",function(s){var r=s.target.sizea;var q=s.target.sizeb;return Math.abs(r-q)}).attr("pct",function(s){var r=Math.round(((s.target.sizea/i_count_total_compare_a)*100)||0);var q=Math.round(((s.target.sizeb/i_count_total_compare_b)*100)||0);return Math.abs(r-q)}).style("opacity",function(x){var t=x.target.sizea;var s=x.target.sizeb;var r=Math.abs(t-s);var v=Math.round(((x.target.sizea/i_count_total_compare_a)*100)||0);var u=Math.round(((x.target.sizeb/i_count_total_compare_b)*100)||0);var q=Math.abs(v-u);var w="0";if(q>=i_slider_compare_value){w="0.5"}return w});j.exit().transition().duration(duration_compare).attr("d",function(r){var q={x:a.x,y:a.y};return diagonal_compare({source:q,target:q})}).remove();c.forEach(function(q){q.x0=q.x;q.y0=q.y})}function collapseAll(){root.children.forEach(collapse);update(root)}function resetZoomPan(){zoom.scale(1);zoom.translate([0,0]);svg.transition().duration(500).attr("transform","translate("+zoom.translate()+") scale("+zoom.scale()+")")}function resetZoomPanCompare(){zoom_compare.scale(1);zoom_compare.translate([0,0]);svg_compare.transition().duration(500).attr("transform","translate("+zoom_compare.translate()+") scale("+zoom_compare.scale()+")")}function traverseFlow(c){var g=c.links.length;var j=new Array();var l=new Array();while(g--){if(s_mode_flow_slider=="real"){if(parseInt(c.links[g].value)<i_min_flow){c.links.splice(g,1)}else{j.push(parseInt(c.links[g].source));l.push(parseInt(c.links[g].target))}}else{if(s_mode_flow_slider=="percentage"){var b=Math.round(((parseInt(c.links[g].value)/i_count_total)*100));if(b<i_min_flow){c.links.splice(g,1)}else{j.push(parseInt(c.links[g].source));l.push(parseInt(c.links[g].target))}}}}var k=[];var e=0;var f=c.nodes.length;while(f--){if(j.indexOf(f)!=-1||l.indexOf(f)!=-1){var a="x"+f;if(!(a in k)){k[a]=e;e++}}else{c.nodes.splice(f,1)}}g=c.links.length;while(g--){var h=c.links[g].target;var d=c.links[g].source;c.links[g].source=(c.nodes.length-k["x"+d]-1);c.links[g].target=(c.nodes.length-k["x"+h]-1)}}function traverse(f,e){if(e=="normal"){if(f.hasOwnProperty("children")){if(typeof f.children!=="undefined"){var a=f.children.length;while(a--){if(s_mode_tree_slider=="real"){if(parseInt(f.children[a].size)<i_min_tree||parseInt(f.children[a].size)>i_max_tree){f.children.splice(a,1)}else{traverse(f.children[a],e)}}else{if(s_mode_tree_slider=="percentage"){var c=Math.round(((parseInt(f.children[a].size)/i_count_total)*100));if(c<i_min_tree||c>i_max_tree){f.children.splice(a,1)}else{traverse(f.children[a],e)}}}}}}}else{if(e=="compare"){if(f.hasOwnProperty("children")){if(typeof f.children!=="undefined"){var a=f.children.length;while(a--){if(s_mode_tree_slider=="real"){if(parseInt(f.children[a].sizea)<i_min_tree||parseInt(f.children[a].sizeb)<i_min_tree||parseInt(f.children[a].sizea)>i_max_tree||parseInt(f.children[a].sizeb)>i_max_tree){f.children.splice(a,1)}else{traverse(f.children[a],e)}}else{if(s_mode_tree_slider=="percentage"){var d=Math.round(((parseInt(f.children[a].sizea)/i_count_total_compare_a)*100));var b=Math.round(((parseInt(f.children[a].sizeb)/i_count_total_compare_b)*100));if(d<i_min_tree||b<i_min_tree||d>i_max_tree||b>i_max_tree){f.children.splice(a,1)}else{traverse(f.children[a],e)}}}}}}}}}function wipeNodes(b){if(b.hasOwnProperty("children")){if(typeof b.children!=="undefined"){var a=b.children.length;while(a--){if(typeof b.children[a]["children"]!=="undefined"){if(b.children[a]["children"].length==0){delete b.children[a]["children"]}else{wipeNodes(b.children[a])}}else{delete b.children[a]["children"]}}}}}var i_min_tree=0;var i_max_tree=0;function update(a){var c=tree.nodes(root).reverse();var n=tree.links(c);var d=svg.selectAll("g.node").data(c,function(p){return p.id||(p.id=++i)});var j=svg.selectAll("path.link").data(n,function(p){return p.target.id});var k=5;var e=180;e=400;var b=parseInt($("#div_tree").css("width"));if(direction=="startevent"){c.forEach(function(p){p.y=(((b-400)/k)*p.depth)+200})}else{if(direction=="endevent"){c.forEach(function(p){p.y=(b-((b-400)/k)*p.depth)-200})}else{if(direction=="throughevent"){c.forEach(function(p){p.y=(b-150)-(p.depth*e)})}}}var g=d.enter().append("g").attr("class","node").attr("transform",function(p){return"translate("+a.y0+","+a.x0+")"}).attr("id",function(p){nodeindex++;return"node-"+nodeindex});var f=svg.append("svg:defs");f.append("svg:pattern").attr("id","pencil").attr("x",0).attr("y",0).attr("width",25).attr("height",25).append("svg:image").attr("xlink:href","/tcj/images/letters_orange.png").attr("x",0).attr("y",0).attr("width",20).attr("height",20);g.append("circle").attr("r",0.000001).attr("id",function(p){nodeindex++;return"node-"+nodeindex}).attr("nodename",function(p){return p.name}).attr("edgemap",function(p){return buildEdgeMap(p)}).attr("edgeidmap",function(p){return buildEdgeIdMap(p)}).attr("class","context-menu-one box menu-1").style("fill",function(p){return p._children?"lightsteelblue":"#fff"}).on("click",click).on("mouseover",function(q){if(s_scoring_options_ref=="ENTIRE PATH + EVENTS ONLY"||s_scoring_options_ref=="ENTIRE PATH + EVENT-TO-EVENT + EVENTS"){var p=buildEdgeMap(q);createNodeToolTip(q.name,p);return o.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px").style("visibility","visible")}}).on("mousemove",function(){return o.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px")}).on("mouseout",function(){return o.style("visibility","hidden")});if(direction=="startevent"){g.append("text").attr("x",function(p){return p.children||p._children?-13:13}).attr("dy",".35em").attr("text-anchor",function(p){return p.children||p._children?"end":"start"}).text(function(q){var p=q.name.substring(0,q.name.lastIndexOf("-"));return p}).style("fill-opacity",0.000001)}else{if(direction=="endevent"){g.append("text").attr("x",function(p){return p.children||p._children?13:-13}).attr("dy",".35em").attr("text-anchor",function(p){return p.children||p._children?"start":"end"}).text(function(q){var p=q.name.substring(0,q.name.lastIndexOf("-"));return p}).style("fill-opacity",0.000001)}else{if(direction=="throughevent"){g.append("text").attr("x",function(p){return p.children||p._children?13:-13}).attr("dy",".35em").attr("text-anchor",function(p){return p.children||p._children?"start":"end"}).text(function(p){return p.name}).style("fill-opacity",0.000001)}}}var h=d.transition().duration(duration).attr("transform",function(p){return"translate("+p.y+","+p.x+")"});h.select("circle").attr("r",10).style("fill",function(p){return p._children?"#dffffb":"#fff"});h.select("text").style("fill-opacity",1);var l=d.exit().transition().duration(duration).attr("transform",function(p){return"translate("+a.y+","+a.x+")"}).remove();l.select("circle").attr("r",0.000001);l.select("text").style("fill-opacity",0.000001);var o=d3.select("div.tooltip");j.enter().insert("path","g").attr("id",function(p){return"link-"+p.source.id+"-"+p.target.id}).attr("class","link").attr("title",function(p){return(p.target.size)}).style("stroke-width",function(p){if(i_max_tree_real==-1||p.target.size>i_max_tree_real){i_max_tree_real=p.target.size}if(i_min_tree_real==-1||p.target.size<i_min_tree_real){i_min_tree_real=p.target.size}if(i_min_tree_real==0){i_min_tree_real=1}return(p.target.width)}).attr("msg",function(p){return p.target.size.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" ("+Math.round(((p.target.size/i_count_total)*100))+"%)"}).on("mouseover",function(p){if(o_scores!=null){createToolTip(p)}else{$(".tooltip").html(p.target.size.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" ("+Math.round(((p.target.size/i_count_total)*100))+"%)")}return o.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px").style("visibility","visible")}).on("mousemove",function(){return o.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px")}).on("mouseout",function(){return o.style("visibility","hidden")}).attr("d",function(q){var p={x:a.x0,y:a.y0};return diagonal({source:p,target:p})});j.transition().duration(duration).attr("d",diagonal);j.exit().transition().duration(duration).attr("d",function(q){var p={x:a.x,y:a.y};return diagonal({source:p,target:p})}).remove();var m=svg.selectAll("#div_tree_container g.link").data(n,function(p){return p.target.id});m.enter().append("g").attr("class","link").style("visibility",s_tree_labels);m.append("rect").attr("height",20).style("stroke","#333333").style("fill","#00796B");m.append("text").attr("fill","#ffffff").attr("y",15).text(function(p){return p.target.size.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" ("+Math.round(((p.target.size/i_count_total)*100))+"%)"});svg.selectAll("#div_tree_container g.link text").attr("width",function(p){o_labels["link-"+p.source.id+"-"+p.target.id]=(this.getBBox().width+20);return(this.getBBox().width+20)});svg.selectAll("#div_tree_container g.link rect").style("stroke-width",1).attr("width",function(p){return o_labels["link-"+p.source.id+"-"+p.target.id]}).attr("x",-10).attr("text-anchor","middle");m.transition().attr("transform",function(p){return"translate("+(((p.source.y+p.target.y)/2)-(o_labels["link-"+p.source.id+"-"+p.target.id]/2)+20)+","+(((p.source.x+p.target.x)/2)-10)+")"});m.exit().transition().remove();c.forEach(function(p){p.x0=p.x;p.y0=p.y})}var s_tree_labels="hidden";viewTreeLabels=function(a){if(svg!=null){if(s_tree_labels=="hidden"){s_tree_labels="visible";$("#div_tree_container .link text").css("visibility","visible");$("#div_tree_container .link rect").css("visibility","visible")}else{$("#div_tree_container .link text").css("visibility","hidden");$("#div_tree_container .link rect").css("visibility","hidden");s_tree_labels="hidden"}}};function createToolTip(k){var n=buildEdgeMap(k.target);var g=n.split(", ");g=g.reverse();var h=g.join(", ");if(direction=="startevent"){n=h}var l=0;var o=0;var p=0;var b=0;var m=0;var e=0;var c=0;var f=0;var j="";j='<span style="font-weight: 700">'+n+"</span>";j+="<br>";j+='Count: <span style="font-weight: 700">'+k.target.size+"</span>";j+="<br>";j+='Percent of Total: <span style="font-weight: 700">'+Math.round(((k.target.size/i_count_total)*100))+"%</span>";if(o_scores!=null&&s_result_set_ref=="ALL"){var a=getScoreFromPath(h);l=a[0];o=a[1];p=a[2];b=a[3];m=a[4];e=a[5];c=a[6];f=a[7];j+="<br>";j+='Score (Sum): <span style="font-weight: 700">'+o+"</span>";j+="<br>";j+='Score (Avg): <span style="font-weight: 700">'+p+"</span>";j+="<br>";j+='Score (StdDev): <span style="font-weight: 700">'+b+"</span>";if(s_scoring_options_ref=="ENTIRE PATH + EVENT-TO-EVENT + EVENTS"){j+="<br><br>";if(direction=="startevent"){j+='<span style="font-weight: 700">'+g[g.length-2]+", "+g[g.length-1]+"</span>"}else{if(direction=="endevent"){j+='<span style="font-weight: 700">'+g[g.length-1]+", "+g[g.length-2]+"</span>"}}if(o_scores!=null){j+="<br>";j+='Score (Sum): <span style="font-weight: 700">'+e+"</span>";j+="<br>";j+='Score (Avg): <span style="font-weight: 700">'+c+"</span>";j+="<br>";j+='Score (StdDev): <span style="font-weight: 700">'+f+"</span>"}}}$(".tooltip").html(j)}function getScoreFromPath(b){var a=o_scores[b].split("|");return a}function createNodeToolTip(b,h){if(s_scoring_options_ref=="ENTIRE PATH + EVENTS ONLY"||s_scoring_options_ref=="ENTIRE PATH + EVENT-TO-EVENT + EVENTS"){if(o_scores!=null){var c=h.split(", ");c=c.reverse();var d=c.join(", ");if(direction=="startevent"){h=d}var f=0;var j=0;var k=0;var a=0;if(o_scores!=null&&s_result_set_ref=="ALL"&&b!="DROP"){var g=getNodeScoreFromPath(d);f=(Math.round(g[0]*100)/100).toFixed(2);j=(Math.round(g[1]*100)/100).toFixed(2);k=(Math.round(g[2]*100)/100).toFixed(2);a=(Math.round(g[3]*100)/100).toFixed(2)}else{if(o_scores!=null&&s_result_set_ref=="ALL"&&b=="DROP"){var g=getScoreFromPath(d);f=(Math.round(g[0]*100)/100).toFixed(2)}}var e='<span style="font-weight: 700">'+b+"</span>";e+="<br>";e+='Count: <span style="font-weight: 700">'+f+"</span>";if(o_scores!=null&&s_result_set_ref=="ALL"&&b!="DROP"){if(!isNaN(j)&&!isNaN(k)&&!isNaN(a)){e+="<br>";e+='Score (Sum): <span style="font-weight: 700">'+j+"</span>";e+="<br>";e+='Score (Avg): <span style="font-weight: 700">'+k+"</span>";e+="<br>";e+='Score (StdDev): <span style="font-weight: 700">'+a+"</span>"}else{e+="<br>";e+='Score (Sum): <span style="font-weight: 700">0</span>';e+="<br>";e+='Score (Avg): <span style="font-weight: 700">0</span>';e+="<br>";e+='Score (StdDev): <span style="font-weight: 700">0</span>'}}$(".tooltip").html(e)}}}function getNodeScoreFromPath(b){var a=o_scores[b].split("|");return[a[8],a[9],a[10],a[11]]}function grabEdgeScores(){var a=$.get("/tcj/aa",{a:"grabedgescores",tsc:s_tstampcode},function(o){if(o.scores!=null){o_scores=o.scores;$(".div_btn_top_scores").css("display","");var b=[];var d=0;$.each(Object.keys(o.scores),function(r,q){var e=o.scores[q].split("|");var s=q.split(", ");if(s.length>1){b[d]=[q,e[0]];d++}});b.sort(sortBySecondColumnDesc);var n=100;if(b.length<100){n=(b.length)}var l="";for(var j=1;j<=n;j++){var k=j;var g=b[j-1];var f=g[1];var p=g[0];if(f>0){var m=800;if(k==1){d_multiplier=(m/f)}var c=(parseInt((f*d_multiplier))-3);l+="<tr><td>"+k+'</td><td style="color: #333333;"><div style="position: absolute; margin-left: -4px; margin-top: -14px; height: 28px; width: '+c+'px; background: #dffffb;"></div><div style="position: absolute; font-size: 10px; width: '+(m-20)+'px; margin-top: -13px; z-index: 10;">'+p+"</div></td><td>"+f+"</td></tr>"}}$("#t_data_list tbody").html(l);$("#t_data_list").trigger("update");k=1;var h="";$.each(Object.keys(o.scores).reverse(),function(s,x){var e=o.scores[x].split("|");var t=x.split(", ");if(s_scoring_options_ref=="ENTIRE PATH ONLY"&&t.length>1||s_scoring_options_ref!="ENTIRE PATH ONLY"){var r=e[0];var v=e[1];var u=e[2];var q=0;if(v>0){var w=640;if(k==1){d_multiplier=(w/v)}if(v>0){q=(parseInt((v*d_multiplier))-3)}}h+="<tr><td>"+k+'</td><td style="color: #333333;"><div style="position: absolute; margin-left: -4px; margin-top: -14px; height: 28px; width: '+q+'px; background: #dffffb;"></div><div style="position: absolute; font-size: 10px; width: '+(w-20)+'px; margin-top: -13px; z-index: 10;">'+x+"</div><td>"+r+"</td><td>"+v+"</td><td>"+u+"</td></tr>";k++}});$("#t_data_list_scores tbody").html(h);$("#t_data_list_scores").trigger("update")}},"json")}function grabEdgeScoresJSON(r){$(".div_btn_top_scores").css("display","");var b=[];var d=0;$.each(Object.keys(r.scores),function(t,f){var e=r.scores[f].split("|");var u=f.split(", ");if(u.length>1){b[d]=[f,e[0]];d++}});b.sort(sortBySecondColumnDesc);var q=100;if(b.length<100){q=(b.length)}var o="";for(var m=1;m<=q;m++){var n=m;var h=b[m-1];var g=h[1];var s=h[0];if(s_direction_set=="endevent"){var k=s.split(", ");var a="";for(var l=(k.length-1);l>=0;l--){a+=k[l]+", "}a=a.substring(0,a.length-2);s=a}if(g>0){var p=800;if(n==1){d_multiplier=(p/g)}var c=(parseInt((g*d_multiplier))-3);o+="<tr><td>"+n+'</td><td style="color: #333333;"><div style="position: absolute; margin-left: -4px; margin-top: -14px; height: 28px; width: '+c+'px; background: #dffffb;"></div><div style="position: absolute; font-size: 10px; width: '+(p-20)+'px; margin-top: -13px; z-index: 10;">'+s+"</div></td><td>"+g+"</td></tr>"}}$("#t_data_list tbody").html(o);$("#t_data_list").trigger("update");n=1;var j="";$.each(Object.keys(r.scores).reverse(),function(w,C){var e=r.scores[C].split("|");var x=C.split(", ");if(s_direction_set=="endevent"){var v="";for(var y=(x.length-1);y>=0;y--){v+=x[y]+", "}v=v.substring(0,v.length-2);C=v}if(s_scoring_options_ref=="ENTIRE PATH ONLY"&&x.length>1||s_scoring_options_ref!="ENTIRE PATH ONLY"){var u=e[0];var A=e[1];var z=e[2];var t=0;if(A>0){var B=640;if(n==1){d_multiplier=(B/A)}if(A>0){t=(parseInt((A*d_multiplier))-3)}}j+="<tr><td>"+n+'</td><td style="color: #333333;"><div style="position: absolute; margin-left: -4px; margin-top: -14px; height: 28px; width: '+t+'px; background: #dffffb;"></div><div style="position: absolute; font-size: 10px; width: '+(B-20)+'px; margin-top: -13px; z-index: 10;">'+C+"</div><td>"+u+"</td><td>"+A+"</td><td>"+z+"</td></tr>";n++}});$("#t_data_list_scores tbody").html(j);$("#t_data_list_scores").trigger("update")}function click(a){if(a.children){a._children=a.children;a.children=null}else{a.children=a._children;a._children=null}update(a)}function click_compare(a){if(a.children){a._children=a.children;a.children=null}else{a.children=a._children;a._children=null}update_compare(a)}highlightEdges=function(e,f){var b=svg.selectAll("path.link").style("stroke","");svg.select("#"+f).style("stroke","#00796B");var c=e.source.parent;var a=e.source;while(c){f="link-"+c.id+"-"+a.id;svg.select("#"+f).style("stroke","#00796B");a=c;c=c.parent}};buildEdgeMap=function(c){var a=c.name+", ";var b=c.parent;while(b){a+=b.name+", ";b=b.parent}a=a.substring(0,a.length-2);return a};buildEdgeIdMap=function(c){var a=c.id+",";var b=c.parent;while(b){a+=b.id+",";b=b.parent}a=a.substring(0,a.length-1);return a};colorEdgePath=function(c,b){var e=c.split(",");for(var d=0;d<e.length;d++){if(d>0){var a="link-"+e[d]+"-"+e[d-1];svg.select("#"+a).style("stroke",b)}}};reColorEdgePaths=function(b){for(var d=0;d<a_target_id_paths.length;d++){var e=a_target_id_paths[d].split(",");for(var c=0;c<e.length;c++){if(c>0){var a="link-"+e[c]+"-"+e[c-1];svg.select("#"+a).style("stroke",b)}}}};deColorEdgePath=function(b){var d=b.split(",");for(var c=0;c<d.length;c++){if(c>0){var a="link-"+d[c]+"-"+d[c-1];svg.select("#"+a).style("stroke","")}}};clearColorEdgePath=function(){if(svg!=null){var b=svg.selectAll("path.link").style("opacity",1).style("stroke","");var a=svg.selectAll("g.node").style("opacity",1).style("pointer-events","all")}};highlightPath=function(l,b){var g=d3.select("#div_tree_container").select("svg");var c=parseInt(g.style("width"));var e=parseInt(g.style("height"));var f=JSON.parse("["+b+"]");var h=l.split(",");if(svg!=null){$("#div_btn_cancel_target_paths").css("display","");var k=d3.select("div.tooltip");var j=svg.selectAll("path.link").style("stroke",function(m){if($.inArray(m.target.id,f)==-1){return d3.select(this).style("stroke")}else{return"#00796B"}}).style("cursor",function(m){if($.inArray(m.target.id,f)==-1){return"default"}else{return"pointer"}}).style("opacity",function(m){if($.inArray(m.target.id,f)==-1){return 0.2}else{return 1}}).on("mouseover",function(m){if($.inArray(m.target.id,f)==-1){return k.style("visibility","hidden")}else{$(".tooltip").html(m.target.size+" ("+Math.round(((m.target.size/i_count_total)*100))+"%)");return k.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px").style("visibility","visible")}}).on("mousemove",function(m){if($.inArray(m.target.id,f)==-1){return k.style("visibility","hidden")}else{return k.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px")}});var a=svg.selectAll("circle").on("click",null);var d=svg.selectAll("g.node").style("pointer-events",function(m){if($.inArray(m.id,f)==-1){return"none"}}).style("opacity",function(m){if($.inArray(m.id,f)==-1){return 0.2}else{return 1}}).on("click",function(p){if($.inArray(p.id,f)!=-1){var m=new Array();var o=new Array();for(var n=0;n<=$.inArray(p.id,f);n++){m.push(f[n]);o.push(h[n])}addToTargetPaths(o.join(),m.join());removeBlock()}})}};getRootNode=function(b,a){var c=JSON.parse("["+a+"]");var d=b.split(",");i_parent_node=c[c.length-1];s_parent_node=d[d.length-1].trim()};removeBlock=function(){if(svg!=null){var b=d3.select("div.tooltip");var c=svg.selectAll("circle").on("click",click);var a=svg.selectAll("path.link").style("cursor","pointer").on("mouseover",function(e){$(".tooltip").html(e.target.size+" ("+Math.round(((e.target.size/i_count_total)*100))+"%)");return b.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px").style("visibility","visible")}).on("mousemove",function(e){return b.style("top",(d3.event.pageY-50)+"px").style("left",(d3.event.pageX+10)+"px")});redrawTargetPaths();$("#div_btn_cancel_target_paths").css("display","none")}else{}};hasScrollbar=function(){return $(document).height()>$(window).height()};function sortBySecondColumnDesc(d,c){if(parseInt(d[1])===parseInt(c[1])){return 0}else{return(parseInt(d[1])>parseInt(c[1]))?-1:1}};